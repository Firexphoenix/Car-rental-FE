<div class="row mb-4">
    <div class="col-12">
        <h2><i class="fas fa-file-contract"></i> Chi Tiết Hợp Đồng</h2>
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/">Trang chủ</a></li>
                <li class="breadcrumb-item"><a href="/contracts">Hợp đồng</a></li>
                <li class="breadcrumb-item active">Chi tiết</li>
            </ol>
        </nav>
    </div>
</div>

{{#if contract}}
<!-- Contract Header -->
<div class="card mb-4">
    <div class="card-header bg-primary text-white">
        <div class="d-flex justify-content-between align-items-center">
            <h4 class="mb-0">
                <i class="fas fa-file-contract"></i> HỢP ĐỒNG THUÊ XE
            </h4>
            <span class="badge bg-{{statusBadge contract.status}} fs-6">
                {{contract.status}}
            </span>
        </div>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-6">
                <h5>Số hợp đồng: <strong>{{contract.contractNumber}}</strong></h5>
            </div>
            <div class="col-md-6 text-end">
                <p class="mb-0">Ngày tạo: {{formatDate contract.createdAt}}</p>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <!-- Renter Information -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-user"></i> Bên Thuê (Renter)</h5>
            </div>
            <div class="card-body">
                {{#if contract.renterInfo}}
                <table class="table table-borderless">
                    <tr>
                        <td width="40%"><strong>Họ tên:</strong></td>
                        <td>{{contract.renterInfo.fullName}}</td>
                    </tr>
                    <tr>
                        <td><strong>Email:</strong></td>
                        <td>{{contract.renterInfo.email}}</td>
                    </tr>
                    <tr>
                        <td><strong>Điện thoại:</strong></td>
                        <td>{{contract.renterInfo.phone}}</td>
                    </tr>
                    <tr>
                        <td><strong>CMND/CCCD:</strong></td>
                        <td>{{contract.renterInfo.idNumber}}</td>
                    </tr>
                    <tr>
                        <td><strong>Địa chỉ:</strong></td>
                        <td>{{contract.renterInfo.address}}</td>
                    </tr>
                </table>
                {{else}}
                <p class="text-muted">Chưa có thông tin</p>
                {{/if}}
            </div>
        </div>
    </div>

    <!-- Owner Information -->
    <div class="col-md-6 mb-4">
        <div class="card h-100">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="fas fa-user-tie"></i> Bên Cho Thuê (Owner)</h5>
            </div>
            <div class="card-body">
                {{#if contract.ownerInfo}}
                <table class="table table-borderless">
                    <tr>
                        <td width="40%"><strong>Họ tên:</strong></td>
                        <td>{{contract.ownerInfo.fullName}}</td>
                    </tr>
                    <tr>
                        <td><strong>Email:</strong></td>
                        <td>{{contract.ownerInfo.email}}</td>
                    </tr>
                    <tr>
                        <td><strong>Điện thoại:</strong></td>
                        <td>{{contract.ownerInfo.phone}}</td>
                    </tr>
                    <tr>
                        <td><strong>CMND/CCCD:</strong></td>
                        <td>{{contract.ownerInfo.idNumber}}</td>
                    </tr>
                    <tr>
                        <td><strong>Địa chỉ:</strong></td>
                        <td>{{contract.ownerInfo.address}}</td>
                    </tr>
                </table>
                {{else}}
                <p class="text-muted">Chưa có thông tin</p>
                {{/if}}
            </div>
        </div>
    </div>
</div>

<!-- Car Information -->
<div class="card mb-4">
    <div class="card-header bg-warning text-white">
        <h5 class="mb-0"><i class="fas fa-car"></i> Thông Tin Xe</h5>
    </div>
    <div class="card-body">
        {{#if contract.car}}
        <div class="row">
            <div class="col-md-6">
                <table class="table table-borderless">
                    <tr>
                        <td width="40%"><strong>Hãng xe:</strong></td>
                        <td>{{contract.car.brand}}</td>
                    </tr>
                    <tr>
                        <td><strong>Model:</strong></td>
                        <td>{{contract.car.model}}</td>
                    </tr>
                    <tr>
                        <td><strong>Biển số:</strong></td>
                        <td><strong class="text-primary">{{contract.car.licensePlate}}</strong></td>
                    </tr>
                </table>
            </div>
            <div class="col-md-6">
                <table class="table table-borderless">
                    <tr>
                        <td width="40%"><strong>Màu sắc:</strong></td>
                        <td>{{contract.car.color}}</td>
                    </tr>
                    <tr>
                        <td><strong>Năm sản xuất:</strong></td>
                        <td>{{contract.car.year}}</td>
                    </tr>
                    <tr>
                        <td><strong>Số chỗ:</strong></td>
                        <td>{{contract.car.seats}} chỗ</td>
                    </tr>
                </table>
            </div>
        </div>
        {{else}}
        <p class="text-muted">Chưa có thông tin xe</p>
        {{/if}}
    </div>
</div>

<!-- Rental Details -->
<div class="card mb-4">
    <div class="card-header bg-secondary text-white">
        <h5 class="mb-0"><i class="fas fa-calendar-alt"></i> Chi Tiết Thuê Xe</h5>
    </div>
    <div class="card-body">
        <div class="row">
            <div class="col-md-4">
                <div class="text-center mb-3">
                    <small class="text-muted">Ngày bắt đầu</small>
                    <h5>{{formatDate contract.startDate}}</h5>
                </div>
            </div>
            <div class="col-md-4">
                <div class="text-center mb-3">
                    <small class="text-muted">Ngày kết thúc</small>
                    <h5>{{formatDate contract.endDate}}</h5>
                </div>
            </div>
            <div class="col-md-4">
                <div class="text-center mb-3">
                    <small class="text-muted">Số ngày thuê</small>
                    <h5>{{contract.rentalDays}} ngày</h5>
                </div>
            </div>
        </div>
        <hr>
        <div class="row">
            <div class="col-md-6">
                <p><strong>Giá thuê/ngày:</strong> {{formatCurrency contract.dailyRate}}</p>
            </div>
            <div class="col-md-6">
                <p><strong>Tiền đặt cọc:</strong> {{formatCurrency contract.deposit}}</p>
            </div>
        </div>
        <div class="alert alert-success">
            <div class="row">
                <div class="col-6">
                    <h5 class="mb-0"><strong>Tổng Tiền:</strong></h5>
                </div>
                <div class="col-6 text-end">
                    <h4 class="mb-0 text-success">{{formatCurrency contract.totalAmount}}</h4>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Terms and Conditions -->
{{#if contract.terms}}
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-list-check"></i> Điều Khoản Hợp Đồng</h5>
    </div>
    <div class="card-body">
        <ol class="ps-3">
            {{#each contract.terms}}
            <li class="mb-2">{{this}}</li>
            {{/each}}
        </ol>
    </div>
</div>
{{/if}}

<!-- Notes -->
{{#if contract.notes}}
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-sticky-note"></i> Ghi Chú</h5>
    </div>
    <div class="card-body">
        <p>{{contract.notes}}</p>
    </div>
</div>
{{/if}}

<!-- Signatures -->
<div class="card mb-4">
    <div class="card-header">
        <h5 class="mb-0"><i class="fas fa-signature"></i> Chữ Ký</h5>
    </div>
    <div class="card-body">
        <div class="row text-center">
            <div class="col-md-6">
                <p class="mb-5"><strong>Bên Thuê</strong></p>
                <p class="border-top d-inline-block px-5">Ký và ghi rõ họ tên</p>
            </div>
            <div class="col-md-6">
                <p class="mb-5"><strong>Bên Cho Thuê</strong></p>
                <p class="border-top d-inline-block px-5">Ký và ghi rõ họ tên</p>
            </div>
        </div>
    </div>
</div>

<!-- Actions -->
<div class="card">
    <div class="card-body">
        <div class="d-flex gap-2 justify-content-end">
            <a href="/contracts" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Quay Lại
            </a>
            <button class="btn btn-primary" onclick="printContract()">
                <i class="fas fa-print"></i> In Hợp Đồng
            </button>
            <button class="btn btn-success" onclick="downloadPDF()">
                <i class="fas fa-file-pdf"></i> Tải PDF
            </button>
            <button class="btn btn-info" onclick="sendEmail()">
                <i class="fas fa-envelope"></i> Gửi Email
            </button>
        </div>
    </div>
</div>

<script>
function printContract() {
    window.print();
}

function downloadPDF() {
    alert('Tính năng tải PDF đang được phát triển');
    // Implement PDF generation
}

function sendEmail() {
    alert('Tính năng gửi email đang được phát triển');
    // Implement email sending
}
</script>

<!-- Print Styles -->
<style media="print">
@media print {
    .navbar,
    footer,
    .breadcrumb,
    .btn,
    .card-footer {
        display: none !important;
    }
    
    .card {
        border: 1px solid #000;
        box-shadow: none;
        page-break-inside: avoid;
    }
    
    body {
        background: white;
    }
}
</style>

{{else}}
<div class="alert alert-warning">
    <i class="fas fa-exclamation-triangle"></i> Không tìm thấy thông tin hợp đồng
</div>
{{/if}}
